# Домашка по оконным функциям в SQL  

## Задача №1
1. Посчитайте количество клиентов, закреплённых за каждым сотрудником (подсказка: в таблице `customer` есть поле *support_rep_id*, которое хранит *employee_id* сотрудника, за которым закреплён клиент). Итоговая таблица должна содержать следующие поля: *id сотрудника*, *полное имя*, *количество клиентов*.  
2. Добавьте к получившейся таблице поле, показывающее какой процент от общей клиентской базы обслуживает каждый сотрудник.  

## Задача №2
1. Для каждого клиента посчитайте сумму продаж по годам и месяцам. Итоговая таблица должна содержать следующие поля: *customer_id*, *full_name*, *monthkey (в числовом формате)*, *total*.
2. Дополните получившуюся таблицу, посчитав для каждого клиента какой процент от общих продаж за каждый месяц он принёс. Т.е. если например в феврале 2023-го общая сумма продаж всем клиентам составила 100, а сумма продаж клиенту Х составила 15, тогда процент расчитывается как 15/100.   
3. Дополните таблицу, посчитав для каждого клиента нарастающий итог за каждый год.  
4. Дополните таблицу, добавив для каждого клиента скользящее среднее за 3 последних периода (2 предыдущих периода и текущий период).  
5. Дополните таблицу, посчитав для каждого клиента разницу между суммой текущего периода и суммой предыдущего периода.  

## Задача №3
1. Для каждого клиента определите дату первой и последней покупки. Посчитайте разницу в годах между первой и последней покупкой. Итоговая таблица должна содержать следующие поля: *customer_id*, *full_name*, *first_purchase_date*, *last_purchase_date*, *diff_in_years*.
